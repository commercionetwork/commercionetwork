(window.webpackJsonp=window.webpackJsonp||[]).push([[83],{397:function(t,s,a){"use strict";a.r(s);var e=a(14),n=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"pricefeed"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pricefeed"}},[t._v("#")]),t._v(" Pricefeed")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("pricefeed")]),t._v(" module allows to external actors (called "),s("em",[t._v("oracles")]),t._v(") to insert into the Commercio.network\nblockchain the current prices of different assets.")]),t._v(" "),s("h2",{attrs:{id:"transactions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#transactions"}},[t._v("#")]),t._v(" Transactions")]),t._v(" "),s("h3",{attrs:{id:"adding-an-oracle"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#adding-an-oracle"}},[t._v("#")]),t._v(" Adding an oracle")]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),s("p",[t._v("This transaction type is accessible only to the "),s("RouterLink",{attrs:{to:"/docs2.1.2/government/"}},[t._v("government")]),t._v("."),s("br"),t._v("\nTrying to perform this transaction without being the government will result in an error.")],1)]),t._v(" "),s("h4",{attrs:{id:"transaction-message"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#transaction-message"}},[t._v("#")]),t._v(" Transaction message")]),t._v(" "),s("p",[t._v("To add a new oracle into the set of current oracles you need to create and sign the following message.")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"type"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"commercio/MsgAddOracle"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"value"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"oracle"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<Did of the oracle to be added>"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"signer"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<Government address>"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"action-type"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#action-type"}},[t._v("#")]),t._v(" Action type")]),t._v(" "),s("p",[t._v("If you want to "),s("RouterLink",{attrs:{to:"/developers/listing-transactions.html"}},[t._v("list past transactions")]),t._v(" including this kind of message,\nyou need to use the following "),s("code",[t._v("message.action")]),t._v(" value:")],1),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("addOracle\n")])])]),s("h3",{attrs:{id:"set-a-price-for-an-asset"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#set-a-price-for-an-asset"}},[t._v("#")]),t._v(" Set a price for an asset")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("In order to perform this transaction you need to be an "),s("em",[t._v("oracle")]),t._v("."),s("br"),t._v("\nIf you wish to become one, please take a look at the "),s("a",{attrs:{href:"#adding-an-oracle"}},[s("em",[t._v('"Adding an oracle"')])]),t._v(" section.")])]),t._v(" "),s("p",[t._v("If you have been added as an oracle you can set a price into the blockchain "),s("strong",[t._v("once every block")]),t._v("."),s("br"),t._v("\nThis means that trying to set a price for the same asset more than once every 6 seconds (the estimated block time)\nwill result in an error when trying to send the transactions.")]),t._v(" "),s("h4",{attrs:{id:"transaction-message-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#transaction-message-2"}},[t._v("#")]),t._v(" Transaction message")]),t._v(" "),s("p",[t._v("In order to set a raw price for a specific asset, you need to create and sign the following message.")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"type"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"commercio/MsgSetPrice"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"value"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"oracle"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<Did of the oracle>"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"price"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"asset_name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<Name of the asset>"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"value"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<Price of the asset (supports decimal numbers)>"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"expiry"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<Block height after which the price should be considered invalid>"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h5",{attrs:{id:"fields-requirements"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#fields-requirements"}},[t._v("#")]),t._v(" Fields requirements")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[t._v("Field")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("Required")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("oracle")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("Yes")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("price")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("Yes")])])])]),t._v(" "),s("h5",{attrs:{id:"price-fields-requirements"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#price-fields-requirements"}},[t._v("#")]),t._v(" "),s("code",[t._v("price")]),t._v(" fields requirements")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"center"}},[t._v("Field")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("Required")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("asset_name")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("Yes")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("value")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("Yes[^1]")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"center"}},[s("code",[t._v("expiry")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("Yes")])])])]),t._v(" "),s("p",[t._v("[^1]: The "),s("code",[t._v("value")]),t._v(" field value must have a 18 decimal digits, for example, to set price "),s("code",[t._v("1")]),t._v(" you must use "),s("code",[t._v("1.000000000000000000")]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"about-the-expiration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#about-the-expiration"}},[t._v("#")]),t._v(" About the expiration")]),t._v(" "),s("p",[t._v("When sending the above message, you will need to specify a valid "),s("code",[t._v("expiry")]),t._v(" value."),s("br"),t._v("\nThe best way to do so is to:")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("Query the latest block height."),s("br"),t._v("\nYou can do so by using the following REST API:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("/blocks/latest\n")])])])]),t._v(" "),s("li",[s("p",[t._v("Once you have the latest block height, add to it "),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[s("semantics",[s("mrow",[s("mi",[t._v("k")]),s("mo",[t._v("=")]),s("mfrac",[s("mi",[t._v("n")]),s("mn",[t._v("6")])],1)],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("k = \\frac{n}{6}")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"base"},[s("span",{staticClass:"strut",staticStyle:{height:"0.6944em"}}),s("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.03148em"}},[t._v("k")]),s("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}}),s("span",{staticClass:"mrel"},[t._v("=")]),s("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}})]),s("span",{staticClass:"base"},[s("span",{staticClass:"strut",staticStyle:{height:"1.0404em","vertical-align":"-0.345em"}}),s("span",{staticClass:"mord"},[s("span",{staticClass:"mopen nulldelimiter"}),s("span",{staticClass:"mfrac"},[s("span",{staticClass:"vlist-t vlist-t2"},[s("span",{staticClass:"vlist-r"},[s("span",{staticClass:"vlist",staticStyle:{height:"0.6954em"}},[s("span",{staticStyle:{top:"-2.655em"}},[s("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),s("span",{staticClass:"sizing reset-size6 size3 mtight"},[s("span",{staticClass:"mord mtight"},[s("span",{staticClass:"mord mtight"},[t._v("6")])])])]),s("span",{staticStyle:{top:"-3.23em"}},[s("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),s("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),s("span",{staticStyle:{top:"-3.394em"}},[s("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),s("span",{staticClass:"sizing reset-size6 size3 mtight"},[s("span",{staticClass:"mord mtight"},[s("span",{staticClass:"mord mathnormal mtight"},[t._v("n")])])])])]),s("span",{staticClass:"vlist-s"},[t._v("â€‹")])]),s("span",{staticClass:"vlist-r"},[s("span",{staticClass:"vlist",staticStyle:{height:"0.345em"}},[s("span")])])])]),s("span",{staticClass:"mclose nulldelimiter"})])])])]),t._v(" where "),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[s("semantics",[s("mrow",[s("mi",[t._v("n")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("n")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"base"},[s("span",{staticClass:"strut",staticStyle:{height:"0.4306em"}}),s("span",{staticClass:"mord mathnormal"},[t._v("n")])])])]),t._v(" is the number of seconds you\nwant the price to be valid for.")])])]),t._v(" "),s("p",[t._v("Please note that adding a price with a block height "),s("strong",[t._v("equals or lower")]),t._v(" than the current block height will result\nin the price never be considered valid and thus never be taken into consideration.")]),t._v(" "),s("p",[t._v("We suggest you to choose a value of "),s("span",{staticClass:"katex"},[s("span",{staticClass:"katex-mathml"},[s("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[s("semantics",[s("mrow",[s("mi",[t._v("k")]),s("mo",[t._v("=")]),s("mn",[t._v("10")])],1),s("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("k = 10")])],1)],1)],1),s("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[s("span",{staticClass:"base"},[s("span",{staticClass:"strut",staticStyle:{height:"0.6944em"}}),s("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.03148em"}},[t._v("k")]),s("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}}),s("span",{staticClass:"mrel"},[t._v("=")]),s("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}})]),s("span",{staticClass:"base"},[s("span",{staticClass:"strut",staticStyle:{height:"0.6444em"}}),s("span",{staticClass:"mord"},[t._v("10")])])])]),t._v(" which will make the price valid for more or less 1 minute.")]),t._v(" "),s("h4",{attrs:{id:"action-type-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#action-type-2"}},[t._v("#")]),t._v(" Action type")]),t._v(" "),s("p",[t._v("If you want to "),s("RouterLink",{attrs:{to:"/developers/listing-transactions.html"}},[t._v("list past transactions")]),t._v(" including this kind of message,\nyou need to use the following "),s("code",[t._v("message.action")]),t._v(" value:")],1),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("setPrice\n")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);